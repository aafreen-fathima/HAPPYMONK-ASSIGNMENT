# Sample sales data
sales_data = [
    # ... (as provided in the question)
]

# Function to calculate total sales revenue for a specified date range
def total_sales_revenue(start_date, end_date):
    total_revenue = 0
    for sale in sales_data:
        sale_date = sale["date"]
        if start_date <= sale_date <= end_date:
            for item in sale["items"]:
                total_revenue += item["quantity"] * item["price"]
    return total_revenue

# Function to identify the top-selling item based on quantity sold
def top_selling_item():
    item_sales = {}
    for sale in sales_data:
        for item in sale["items"]:
            item_name = item["item"]
            item_quantity = item["quantity"]
            if item_name in item_sales:
                item_sales[item_name] += item_quantity
            else:
                item_sales[item_name] = item_quantity
    top_item = max(item_sales, key=item_sales.get)
    return top_item

# Function to determine the most frequent customer (who made the most purchases)
def most_frequent_customer():
    customer_purchases = {}
    for sale in sales_data:
        customer_name = sale["customer"]
        if customer_name in customer_purchases:
            customer_purchases[customer_name] += 1
        else:
            customer_purchases[customer_name] = 1
    frequent_customer = max(customer_purchases, key=customer_purchases.get)
    return frequent_customer

# Function to identify the customer who spent the most money in total
def customer_who_spent_the_most():
    customer_spending = {}
    for sale in sales_data:
        customer_name = sale["customer"]
        sale_total = sum(item["quantity"] * item["price"] for item in sale["items"])
        if customer_name in customer_spending:
            customer_spending[customer_name] += sale_total
        else:
            customer_spending[customer_name] = sale_total
    top_spending_customer = max(customer_spending, key=customer_spending.get)
    return top_spending_customer

# Function to calculate total revenue generated by each item
def total_revenue_by_item():
    item_revenue = {}
    for sale in sales_data:
        for item in sale["items"]:
            item_name = item["item"]
            item_quantity = item["quantity"]
            item_price = item["price"]
            total_item_revenue = item_quantity * item_price
            if item_name in item_revenue:
                item_revenue[item_name] += total_item_revenue
            else:
                item_revenue[item_name] = total_item_revenue
    return item_revenue

# Function to find the date with the highest sales revenue
def date_with_highest_revenue():
    date_revenue = {}
    for sale in sales_data:
        sale_date = sale["date"]
        sale_total = sum(item["quantity"] * item["price"] for item in sale["items"])
        if sale_date in date_revenue:
            date_revenue[sale_date] += sale_total
        else:
            date_revenue[sale_date] = sale_total
    highest_revenue_date = max(date_revenue, key=date_revenue.get)
    return highest_revenue_date

# Function to display the menu and process user input
def main():
    while True:
        print("Menu:")
        print("1. Total Sales Revenue for Date Range")
        print("2. Top-Selling Item")
        print("3. Most Frequent Customer")
        print("4. Customer Who Spent the Most")
        print("5. Total Revenue by Item")
        print("6. Date with Highest Sales Revenue")
        print("7. Quit")
        
        choice = input("Enter your choice (1-7): ")

        if choice == "1":
            start_date = input("Enter start date (YYYY-MM-DD): ")
            end_date = input("Enter end date (YYYY-MM-DD): ")
            revenue = total_sales_revenue(start_date, end_date)
            print(f"Total sales revenue for the specified date range: ${revenue:.2f}")
        elif choice == "2":
            top_item = top_selling_item()
            print(f"Top-selling item: {top_item}")
        elif choice == "3":
            frequent_customer = most_frequent_customer()
            print(f"Most frequent customer: {frequent_customer}")
        elif choice == "4":
            top_spending_customer = customer_who_spent_the_most()
            print(f"Customer who spent the most: {top_spending_customer}")
        elif choice == "5":
            item_revenue = total_revenue_by_item()
            print("Total revenue by item:")
            for item, revenue in item_revenue.items():
                print(f"{item}: ${revenue:.2f}")
        elif choice == "6":
            highest_revenue_date = date_with_highest_revenue()
            print(f"Date with the highest sales revenue: {highest_revenue_date}")
        elif choice == "7":
            break
        else:
            print("Invalid choice. Please enter a valid option (1-7).")

if __name__ == "__main__":
    main()
